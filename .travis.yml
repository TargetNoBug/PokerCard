language: objective-c
osx_image: xcode11

env:
  global:
  - WORKSPACE=PokerCard.xcworkspace
  - SCHEME="PokerCard"
  - EXAMPLE_SCHEME="Example"
  matrix:
  - DESTINATION="platform=iOS Simulator,name=iPhone 8"

script:
- set -o pipefail
- xcodebuild clean build -workspace "$WORKSPACE" -scheme "$SCHEME" -destination "$DESTINATION" | xcpretty
- xcodebuild clean build -workspace "$WORKSPACE" -scheme "$EXAMPLE_SCHEME" -destination "$DESTINATION" | xcpretty
- pod lib lint

before_deploy:
- xcodebuild -scheme "$SCHEME" -workspace "$WORKSPACE" build
- carthage archive $SCHEME
deploy:
  provider: releases
  file: PokerCard.framework.zip
  skip_cleanup: true
  github-token: $GITHUB_TOKEN
  on:
    repo: iWeslie/PokerCard
    tags: true
